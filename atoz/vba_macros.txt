Sub import_process()
'
' import_process Macro
'

'
    With ActiveSheet.QueryTables.Add(Connection:= _
        "TEXT;C:\Users\BUNICE\Documents\GitHub\XSLT_signalement_docelec\atoz\rsc_txt.txt", Destination:=Range("$A$1"))
        .Name = "rsc_txt"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .TextFilePromptOnRefresh = False
        .TextFilePlatform = 1252
        .TextFileStartRow = 1
        .TextFileParseType = xlDelimited
        .TextFileTextQualifier = xlTextQualifierDoubleQuote
        .TextFileConsecutiveDelimiter = False
        .TextFileTabDelimiter = True
        .TextFileSemicolonDelimiter = False
        .TextFileCommaDelimiter = False
        .TextFileSpaceDelimiter = False
        .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, _
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)
        .TextFileTrailingMinusNumbers = True
        .Refresh BackgroundQuery:=False
    End With
	
	 Columns("AB:AN").Select
    Selection.Delete Shift:=xlToLeft
    Columns("U:Z").Select
    Selection.Delete Shift:=xlToLeft
    Columns("T:T").Select
    Selection.Delete Shift:=xlToLeft
    Columns("P:Q").Select
    Selection.Delete Shift:=xlToLeft
    Columns("J:K").Select
    Range("K1").Activate
    Selection.Delete Shift:=xlToLeft
    Columns("H:H").Select
    Selection.Delete Shift:=xlToLeft
End Sub

Sub copy_map()
'
' copy_map Macro
'
    Cells.Select
    Selection.Copy
    Sheets.Add After:=ActiveSheet
    Cells.Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = True
	
	ActiveWorkbook.XmlMaps.Add( _
        "C:\Users\BUNICE\Documents\GitHub\XSLT_signalement_docelec\atoz\mappage_atoz.xsd", "Resources") _
        .Name = "Resources_Mappage"

End Sub

Sub export()
'
' export Macro
'
Dim mapProperties As XmlMap 
Dim pathProperties As String

pathProperties = "C:\Users\BUNICE\Documents\GitHub\XSLT_signalement_docelec\atoz\rsc_export.xml"
Set mapProperties = ActiveWorkbook.XmlMaps("Resources_Mappage")
If mapProperties.IsExportable Then mapProperties.Export URL:=pathProperties, Overwrite:=True

End Sub

Sub XSLTransform()
On Error GoTo ErrHandle
    Dim xmldoc As New MSXML2.DOMDocument, xslDoc As New MSXML2.DOMDocument
    Dim newDoc As New MSXML2.DOMDocument

    ' LOAD XML AND XSL FILES
    xmlDoc.async = False
    xmlDoc.Load "C:\Path\To\InputXML.xml"

    xslDoc.async = False    
    xslDoc.Load "C:\Path\To\XSLT_Script.xml"        

    ' TRANSFORM XML 
    xmldoc.transformNodeToObject xslDoc, newDoc
    newDoc.Save "C:\Path\To\OutputXML.xml"

    Set xmlDoc = Nothing: Set xslDoc = Nothing: Set newDoc = Nothing
End Sub

